var e=Object.defineProperty,t=(t,n,r)=>((t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r)(t,"symbol"!=typeof n?n+"":n,r);import{Y as n,Z as r}from"./misc-vendor-C-TUhJNj.js";const o={},a=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),a=n?.nonce||n?.getAttribute("nonce");r=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in o)return;o[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,a&&r.setAttribute("nonce",a),document.head.appendChild(r),t?new Promise((t,n)=>{r.addEventListener("load",t),r.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})};class s{static simpleEncrypt(e){try{let t="";const n=this.ENCRYPTION_KEY;for(let r=0;r<e.length;r++)t+=String.fromCharCode(e.charCodeAt(r)^n.charCodeAt(r%n.length));return btoa(t)}catch(t){return e}}static simpleDecrypt(e){try{const t=atob(e);let n="";const r=this.ENCRYPTION_KEY;for(let e=0;e<t.length;e++)n+=String.fromCharCode(t.charCodeAt(e)^r.charCodeAt(e%r.length));return n}catch(t){return e}}static generateRandomToken(e=32){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let n="";if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues)try{const r=new Uint8Array(e);window.crypto.getRandomValues(r);for(let o=0;o<e;o++)n+=t[r[o]%62];return n}catch{}for(let r=0;r<e;r++)n+=t.charAt(Math.floor(62*Math.random()));return n+Date.now().toString(36)}static hasSecureRandom(){return"undefined"!=typeof window&&window.crypto&&"function"==typeof window.crypto.getRandomValues}static isCryptoJSAvailable(){try{if("undefined"==typeof window)return!1;const e=window.CryptoJS;return!!(e&&"object"==typeof e&&e.AES&&e.lib)}catch{return!1}}}t(s,"ENCRYPTION_KEY","TableTech-2024-SecureKey-Default");const i="TableTech-2024-SecureKey-Default";var c=(e=>(e.NECESSARY="necessary",e.FUNCTIONAL="functional",e.ANALYTICS="analytics",e.MARKETING="marketing",e.PERFORMANCE="performance",e))(c||{});const l=[{name:"tabletech_session",category:"necessary",provider:"TableTech",purpose:"Maintains user session during website visit",duration:"Session",type:"first-party",encrypted:!0},{name:"csrf_token",category:"necessary",provider:"TableTech",purpose:"Protects against Cross-Site Request Forgery attacks",duration:"Session",type:"first-party",encrypted:!0},{name:"cookieconsent_status",category:"necessary",provider:"TableTech",purpose:"Stores cookie consent preferences",duration:"12 months",type:"first-party"},{name:"i18nextLng",category:"functional",provider:"TableTech",purpose:"Stores language preference (NL/EN)",duration:"12 months",type:"first-party"},{name:"timezone",category:"functional",provider:"TableTech",purpose:"Stores user timezone for correct time display",duration:"30 days",type:"first-party"},{name:"form_data_temp",category:"functional",provider:"TableTech",purpose:"Temporarily stores form data to prevent data loss",duration:"Session",type:"first-party",encrypted:!0},{name:"_ga",category:"analytics",provider:"Google Analytics",purpose:"Distinguishes unique users",duration:"2 years",type:"first-party"},{name:"_gid",category:"analytics",provider:"Google Analytics",purpose:"Distinguishes unique users",duration:"24 hours",type:"first-party"},{name:"_gat_gtag_*",category:"analytics",provider:"Google Analytics",purpose:"Throttles request rate",duration:"1 minute",type:"first-party"},{name:"_ga_*",category:"analytics",provider:"Google Analytics 4",purpose:"Stores session state and campaign info",duration:"2 years",type:"first-party"},{name:"_fbp",category:"marketing",provider:"Facebook/Meta",purpose:"Facebook Pixel for ad tracking",duration:"3 months",type:"third-party"},{name:"IDE",category:"marketing",provider:"Google/Doubleclick",purpose:"Google Ads remarketing",duration:"13 months",type:"third-party"},{name:"__cf_bm",category:"performance",provider:"Cloudflare",purpose:"Bot management and security",duration:"30 minutes",type:"first-party"}],p=class e{constructor(){t(this,"consent",null),t(this,"CONSENT_COOKIE","cookieconsent_status"),t(this,"CONSENT_VERSION","1.0.0"),t(this,"SECURE_FLAGS",{secure:!0,sameSite:"strict",expires:365});try{this.loadConsent(),this.initializeCSRF()}catch(e){}}static getInstance(){return e.instance||(e.instance=new e),e.instance}initializeCSRF(){try{this.getCSRFToken()||this.generateCSRFToken()}catch(e){}}generateCSRFToken(){try{let e;e=n&&n.lib&&n.lib.WordArray&&"function"==typeof n.lib.WordArray.random?n.lib.WordArray.random(32).toString():s.generateRandomToken(32);const t=this.encrypt(e);return this.setCookie("csrf_token",t,{...this.SECURE_FLAGS,expires:void 0,sameSite:"strict"}),e}catch(e){const t=s.generateRandomToken(32);return this.setCookie("csrf_token",t,{...this.SECURE_FLAGS,expires:void 0,sameSite:"strict"}),t}}getCSRFToken(){const e=r.get("csrf_token");if(e)try{return this.decrypt(e)}catch{return null}return null}validateCSRFToken(e){const t=this.getCSRFToken();return null!==t&&t===e}encrypt(e){try{return n&&n.AES&&"function"==typeof n.AES.encrypt?n.AES.encrypt(e,i).toString():s.simpleEncrypt(e)}catch(t){return s.simpleEncrypt(e)}}decrypt(e){try{return n&&n.AES&&"function"==typeof n.AES.decrypt?n.AES.decrypt(e,i).toString(n.enc.Utf8):s.simpleDecrypt(e)}catch(t){try{return s.simpleDecrypt(e)}catch{return e}}}loadConsent(){const e=r.get(this.CONSENT_COOKIE);if(e)try{this.consent=JSON.parse(e)}catch{this.consent=null}}saveConsent(e){this.consent={necessary:!0,functional:e.functional??!1,analytics:e.analytics??!1,marketing:e.marketing??!1,performance:e.performance??!1,timestamp:Date.now(),version:this.CONSENT_VERSION},r.set(this.CONSENT_COOKIE,JSON.stringify(this.consent),{...this.SECURE_FLAGS,expires:365}),this.applyConsent()}getConsent(){return this.consent}hasConsent(e){if(!this.consent)return"necessary"===e;switch(e){case"necessary":return!0;case"functional":return this.consent.functional;case"analytics":return this.consent.analytics;case"marketing":return this.consent.marketing;case"performance":return this.consent.performance;default:return!1}}applyConsent(){const e=r.get();l.forEach(t=>{this.hasConsent(t.category)||Object.keys(e).forEach(e=>{(e===t.name||t.name.includes("*")&&new RegExp(t.name.replace("*",".*")).test(e))&&(r.remove(e),r.remove(e,{path:"/"}),r.remove(e,{domain:".tabletech.nl"}))})}),this.hasConsent("analytics")?this.enableGoogleAnalytics():this.disableGoogleAnalytics(),this.hasConsent("marketing")||this.disableMarketingScripts()}enableGoogleAnalytics(){"undefined"!=typeof window&&window.gtag&&window.gtag("consent","update",{analytics_storage:"granted"})}disableGoogleAnalytics(){"undefined"!=typeof window&&(window["ga-disable-G-GV8ZVCHNFE"]=!0,window.gtag&&window.gtag("consent","update",{analytics_storage:"denied"}),["_ga","_gid","_gat","_gat_gtag_UA"].forEach(e=>{r.remove(e),r.remove(e,{path:"/"}),r.remove(e,{domain:".tabletech.nl"})}))}disableMarketingScripts(){"undefined"!=typeof window&&window.fbq&&(window.fbq=()=>{}),["_fbp","fr","IDE","test_cookie"].forEach(e=>{r.remove(e),r.remove(e,{path:"/"}),r.remove(e,{domain:".tabletech.nl"})})}setCookie(e,t,n,o){const a=l.find(t=>t.name===e);if(a&&!this.hasConsent(a.category))return;const s=o||a?.encrypted?this.encrypt(t):t;r.set(e,s,{...this.SECURE_FLAGS,...n})}getCookie(e,t){const n=l.find(t=>t.name===e),o=r.get(e);if(o){if(t||n?.encrypted)try{return this.decrypt(o)}catch{return}return o}}removeCookie(e){r.remove(e),r.remove(e,{path:"/"}),r.remove(e,{domain:".tabletech.nl"})}clearAllCookies(e=!0){const t=r.get();Object.keys(t).forEach(t=>{const n=l.find(e=>e.name===t||e.name.includes("*")&&new RegExp(e.name.replace("*",".*")).test(t));e&&n&&"necessary"===n.category||this.removeCookie(t)})}getCookiesByCategory(e){return l.filter(t=>t.category===e)}getAllCookieDefinitions(){return l}getActiveCookies(){return Object.keys(r.get())}generateSecureSession(){try{let e;e=n&&n.lib&&n.lib.WordArray&&"function"==typeof n.lib.WordArray.random?n.lib.WordArray.random(32).toString():s.generateRandomToken(32);const t=this.encrypt(e);return this.setCookie("tabletech_session",t,{expires:void 0,sameSite:"strict",secure:!0}),e}catch(e){const t=s.generateRandomToken(32);return this.setCookie("tabletech_session",t,{expires:void 0,sameSite:"strict",secure:!0}),t}}validateSession(e){return this.getCookie("tabletech_session",!0)===e}updateConsentVersion(e){this.consent&&this.consent.version!==e&&(this.consent=null,this.removeCookie(this.CONSENT_COOKIE))}};t(p,"instance");const u=p.getInstance(),d=class e{constructor(){t(this,"CSP_NONCE_LENGTH",16),this.initializeSecurityHeaders()}static getInstance(){return e.instance||(e.instance=new e),e.instance}initializeSecurityHeaders(){"undefined"!=typeof window&&(this.setMetaTag("referrer","strict-origin-when-cross-origin"),this.ensureCSRFToken())}setMetaTag(e,t){let n=document.querySelector(`meta[name="${e}"]`);n||(n=document.createElement("meta"),n.name=e,document.head.appendChild(n)),n.content=t}generateNonce(){return n.lib.WordArray.random(this.CSP_NONCE_LENGTH).toString()}getCSPHeader(e){return["default-src 'self'",`script-src 'self' 'nonce-${e}' 'unsafe-inline' 'unsafe-eval' https://www.googletagmanager.com https://www.google-analytics.com https://challenges.cloudflare.com`,"style-src 'self' 'unsafe-inline'","img-src 'self' data: https: blob:","font-src 'self' data: https://r2cdn.perplexity.ai","connect-src 'self' https://www.google-analytics.com https://www.googletagmanager.com https://region1.google-analytics.com https://api.tabletech.nl https://tabletech.nl http://localhost:3002 ws://localhost:* wss://localhost:*","frame-src 'self' https://www.youtube.com https://player.vimeo.com https://challenges.cloudflare.com","base-uri 'self'","form-action 'self'","upgrade-insecure-requests","block-all-mixed-content"].join("; ")}sanitizeInput(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}validateEmail(e){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e)&&e.length<=254}validatePhone(e){return/^(\+31|0031|0)[1-9][0-9]{8}$|^\+[1-9][0-9]{1,14}$/.test(e.replace(/[\s-]/g,""))}validateUrl(e){try{const t=new URL(e);return["http:","https:"].includes(t.protocol)}catch{return!1}}ensureCSRFToken(){let e=u.getCSRFToken();return e||(e=u.generateCSRFToken()),e}addCSRFToRequest(e){const t=this.ensureCSRFToken(),n=new Headers(e.headers||{});return n.set("X-CSRF-Token",t),{...e,headers:n,credentials:"same-origin"}}validateCSRFToken(e){return u.validateCSRFToken(e)}hashPassword(e,t){const r=t||n.lib.WordArray.random(16).toString();return`${r}:${n.PBKDF2(e,r,{keySize:8,iterations:1e4}).toString()}`}verifyPassword(e,t){const[n]=t.split(":");return this.hashPassword(e,n)===t}generateSecureRandomString(e=32){return n.lib.WordArray.random(e).toString()}encryptData(e,t){const r=JSON.stringify(e),o=t||"TableTech-Default-Key";return n.AES.encrypt(r,o).toString()}decryptData(e,t){try{const r=t||"TableTech-Default-Key",o=n.AES.decrypt(e,r).toString(n.enc.Utf8);return JSON.parse(o)}catch{return null}}rateLimit(e,t=5,n=9e5){const r=Date.now(),o=`rate_limit_${e}`,a=localStorage.getItem(o),s=a?JSON.parse(a):{attempts:[],blockedUntil:0};return!(s.blockedUntil>r||(s.attempts=s.attempts.filter(e=>r-e<n),s.attempts.length>=t?(s.blockedUntil=r+n,localStorage.setItem(o,JSON.stringify(s)),1):(s.attempts.push(r),localStorage.setItem(o,JSON.stringify(s)),0)))}clearRateLimit(e){localStorage.removeItem(`rate_limit_${e}`)}detectSuspiciousActivity(e){const t=JSON.stringify(e).toLowerCase();return[/<script[^>]*>.*?<\/script>/gi,/javascript:/gi,/on\w+\s*=/gi,/eval\(/gi,/document\.cookie/gi,/window\.location/gi,/<iframe/gi,/base64,/gi,/union.*select/gi,/drop.*table/gi,/insert.*into/gi,/select.*from/gi].some(e=>e.test(t))}sanitizeFormData(e){const t={};for(const[n,r]of Object.entries(e))"string"==typeof r?t[n]=this.sanitizeInput(r):"object"!=typeof r||null===r||Array.isArray(r)?t[n]=r:t[n]=this.sanitizeFormData(r);return t}generateSessionToken(){const e=this.generateSecureRandomString(32),t=Date.now();return`${e}:${t}:${n.HmacSHA256(`${e}:${t}`,"TableTech-Session-Secret").toString()}`}validateSessionToken(e){try{const[t,r,o]=e.split(":");if(o!==n.HmacSHA256(`${t}:${r}`,"TableTech-Session-Secret").toString())return!1;const a=parseInt(r);return Date.now()-a<864e5}catch{return!1}}getSecurityHeaders(){const e=this.generateNonce();return{"Content-Security-Policy":this.getCSPHeader(e),"X-Content-Type-Options":"nosniff","X-Frame-Options":"DENY","X-XSS-Protection":"1; mode=block","Referrer-Policy":"strict-origin-when-cross-origin","Permissions-Policy":"geolocation=(), microphone=(), camera=()","Strict-Transport-Security":"max-age=31536000; includeSubDomains; preload","X-Permitted-Cross-Domain-Policies":"none","X-Download-Options":"noopen","X-DNS-Prefetch-Control":"off","CSP-Nonce":e}}logSecurityEvent(e,t){const n={type:e,timestamp:(new Date).toISOString(),details:t,userAgent:navigator.userAgent,url:window.location.href},r=JSON.parse(localStorage.getItem("security_events")||"[]");r.push(n),r.length>100&&r.shift(),localStorage.setItem("security_events",JSON.stringify(r)),fetch("/api/security/log",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":this.ensureCSRFToken()},body:JSON.stringify(n)}).catch(()=>{})}};t(d,"instance");const m=d.getInstance(),g=()=>{const e="true"===sessionStorage.getItem("openCookieSettings");return e&&sessionStorage.removeItem("openCookieSettings"),e};function y(...e){return e.filter(Boolean).join(" ")}const h=()=>"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://localhost:3002/api":"https://tabletech.nl/api",f=async e=>{const t=h(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),r={restaurantName:e.restaurant||"Niet opgegeven",contactPerson:`${e.firstName} ${e.lastName}`.trim(),email:e.email,phone:e.phone,date:e.preferredDate,time:e.preferredTime,message:e.message||"Demo afspraak aangevraagd via website"};try{const e=await fetch(`${t}/v2/appointments`,{method:"POST",headers:{"Content-Type":"application/json","X-Idempotency-Key":n,"X-Client-Version":"2.0.0"},body:JSON.stringify(r)}),o=await e.json();return e.ok?{ok:o.success,requestId:o.referenceNumber||n,message:o.message||"Afspraak succesvol gemaakt"}:{ok:!0,requestId:n,message:"Afspraak geregistreerd (demo mode)"}}catch(o){return{ok:!0,requestId:n,message:"Afspraak geregistreerd (offline mode)"}}},S=async(e,t)=>{const n=h();try{const r=await fetch(`${n}/v2/appointments/available-dates?year=${e}&month=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok){const n=new Date(e,t-1,0).getDate(),r=[];for(let o=1;o<=n;o++){const n=new Date(e,t-1,o),a=n.getDay();if(0===a||6===a)continue;const s=new Date;if(s.setHours(0,0,0,0),n<s)continue;const i=`${e}-${String(t).padStart(2,"0")}-${String(o).padStart(2,"0")}`;r.push(i)}return r}return(await r.json()).availableDates||[]}catch(r){return[]}},w=async e=>{const t=[{time:"09:00",isAvailable:!0},{time:"09:30",isAvailable:!0},{time:"10:00",isAvailable:!0},{time:"10:30",isAvailable:!0},{time:"11:00",isAvailable:!0},{time:"11:30",isAvailable:!0},{time:"13:00",isAvailable:!0},{time:"13:30",isAvailable:!0},{time:"14:00",isAvailable:!0},{time:"14:30",isAvailable:!0},{time:"15:00",isAvailable:!0},{time:"15:30",isAvailable:!0},{time:"16:00",isAvailable:!0},{time:"16:30",isAvailable:!0}],n=h();try{const r=await fetch(`${n}/v2/appointments/slots?date=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)return t;const o=await r.json();return o.success&&o.slots?o.slots:t}catch(r){return t}};export{c as C,a as _,g as a,y as b,u as c,w as d,f as e,S as g,m as s};
